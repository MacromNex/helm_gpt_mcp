{
  "_description": "Configuration for cyclic peptide optimization using HELM-GPT agent training",
  "_source": "Based on repo/helm-gpt/train_agent.py",

  "training": {
    "n_steps": 500,
    "batch_size": 32,
    "sigma": 60,
    "learning_rate": 1e-4,
    "max_len": 140,
    "save_every_n_steps": 100
  },

  "loss": {
    "type": "reinvent_cpl",
    "alpha": 1.0,
    "types_available": ["reinvent", "cpl", "reinvent_cpl"]
  },

  "tasks": {
    "permeability": {
      "description": "Optimize for cell membrane permeability",
      "scoring_functions": ["permeability"],
      "weights": [1.0],
      "score_type": "weight"
    },
    "kras_kd": {
      "description": "Optimize for KRAS protein binding affinity (KD)",
      "scoring_functions": ["kras_kd"],
      "weights": [1.0],
      "score_type": "weight"
    },
    "kras_perm": {
      "description": "Multi-objective: KRAS binding + permeability",
      "scoring_functions": ["permeability", "kras_kd"],
      "weights": [1.0, 1.0],
      "score_type": "sum"
    }
  },

  "device": {
    "preference": "auto",
    "use_amp": true,
    "comment": "auto selects CUDA if available, otherwise CPU"
  },

  "output": {
    "save_checkpoints": true,
    "save_step_data": true,
    "generate_samples": true,
    "sample_count": 50,
    "top_sequences_count": 10
  },

  "models": {
    "permeability_model": "examples/data/models/regression_rf.pkl",
    "kras_model": "examples/data/models/kras_xgboost_reg.pkl"
  },

  "limits": {
    "max_n_steps": 10000,
    "max_batch_size": 256,
    "timeout_minutes": 480
  }
}
